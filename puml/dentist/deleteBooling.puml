@startuml Delete Dentist (DELETE)

footer Page %page% of %lastpage%
title "Delete Dentist"

participant "User" as user
participant "<<JavaScript>>\n:server" as server
participant "<<router>>\n:dentists" as routerDentists
participant "<<controllers>>\n:dentists" as controllersDentists
participant "<<model>>\n:Dentist" as modelDentist
participant "<<model>>\n:Booking" as modelBooking
database "<<MongoDB>>\n:dentists" as DentistsDatabase
database "<<MongoDB>>\n:bookings" as BookingsDatabase

user -> server ++ : req.delete('/api/v1/dentists/:id')
server -> routerDentists ++ : app.use('/api/v1/dentists', dentists)
routerDentists -> controllersDentists ++ : deleteDentist()
controllersDentists -> modelDentist ++ : findById(req.params.id)
modelDentist -> DentistsDatabase ++ : DentistSchema
DentistsDatabase --> modelDentist -- : dentist

alt Dentist Found
    controllersDentists <-- modelDentist -- : dentist
    controllersDentists -> modelBooking ++ : deleteMany({ dentist: req.params.id })
    modelBooking -> BookingsDatabase ++ : Delete associated bookings
    BookingsDatabase --> modelBooking -- : bookings deleted
    controllersDentists -> modelDentist ++ : deleteOne({ _id: req.params.id })
    modelDentist -> DentistsDatabase ++ : Delete dentist record
    DentistsDatabase --> modelDentist -- : dentist deleted
    controllersDentists -> user -- : JSON response { success: true, data: {} }
else Dentist Not Found
    controllersDentists -> user -- : JSON response { success: false, message: "Dentist not found" }
end

@enduml
